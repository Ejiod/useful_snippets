%macro merge_datasets;
%macro generate_datasets;
    /* Step 1: Generate macro variables for each dataset name */
    %do year = 2012 %to 2014;
        %let short_year = %substr(&year., 3); 
        %do month = 1 %to 12;
            %let monthname = %sysfunc(monthname(&month. 01));
            %let monthname = %substr(&monthname., 1, 3);
            %let monthname = %lowcase(&monthname.);
            
            /* Store dataset name in a macro variable */
            %let dataset&month.&short_year = temp.xxxxx&monthname.&short_year._trigger;
        %end;
    %end;
    
    /* Step 2: Loop through the macro variables and process datasets */
    data merged_data;
        %do year = 12 %to 14;
            %do month = 1 %to 12;
                set &&dataset&month.&year.;  /* Double ampersand is used for macro variable resolution */
            %end;
        %end;
    run;
%mend generate_datasets;

%generate_datasets;






%macro generate_datasets;

    /* Create an empty dataset to initialize the merge */
    data merged_data; 
    stop; 
    run;

    %do year = 2012 %to 2014;
        %let short_year = %substr(&year., 3); 
        %do month = 1 %to 12;
            %let monthname = %sysfunc(monthname(&month. 01));
            %let monthname = %substr(&monthname., 1, 3);
            %let monthname = %lowcase(&monthname.);

            /* Directly concatenate datasets */
            data merged_data;
                set merged_data temp.xxx_&monthname.&short_year._trigger;
            run;

        %end;
    %end;

%mend generate_datasets;

%generate_datasets;

