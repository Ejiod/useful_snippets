import pandas as pd
import phonenumbers

def clean_phone_number(phone):
    try:
        # Parse the phone number with a None region to automatically detect country code
        parsed_phone = phonenumbers.parse(phone, None)
        # Format the phone number in international format
        formatted_phone = phonenumbers.format_number(parsed_phone, phonenumbers.PhoneNumberFormat.INTERNATIONAL)
        return formatted_phone
    except phonenumbers.NumberParseException:
        return phone

# Read the Excel file
file_path = 'path_to_your_excel_file.xlsx'
df = pd.read_excel(file_path)

# Assume the phone numbers are in a column named 'Phone'
df['Cleaned_Phone'] = df['Phone'].apply(clean_phone_number)

# Save the updated DataFrame back to Excel
output_path = 'path_to_save_cleaned_excel_file.xlsx'
df.to_excel(output_path, index=False)

print(f"Cleaned phone numbers saved to {output_path}")